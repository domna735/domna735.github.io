<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="color-scheme" content="dark light" />

    <title>Real-time Facial Expression Recognition System — Donovan Ma</title>
    <meta
      name="description"
      content="A reproducible real-time FER system with teacher→student distillation, calibration, and deployment-facing evaluation under domain shift (stability/jitter)."
    />

    <link rel="alternate" hreflang="en" href="real-time-fer.html" />
    <link rel="alternate" hreflang="zh-HK" href="real-time-fer-zh.html" />

    <link rel="stylesheet" href="../styles.css" />
    <link rel="icon" href="data:," />
  </head>

  <body>
    <a class="skip-link" href="#main">Skip to content</a>

    <header class="site-header">
      <div class="container header-row">
        <div class="brand">
          <a class="brand-link" href="../index.html#top" aria-label="Go to home">Donovan Ma</a>
          <span class="brand-sub">Information Security · ML/CV · Real-time Systems</span>
        </div>

        <nav class="nav" aria-label="Primary">
          <a class="nav-link" href="../index.html#projects">Projects</a>
          <a class="nav-link" href="../index.html#education">Education</a>
          <a class="nav-link" href="../index.html#skills">Skills</a>
          <a class="nav-link" href="../index.html#experience">Experience</a>
          <a class="nav-link" href="../index.html#contact">Contact</a>
          <a class="nav-link" href="real-time-fer-zh.html" lang="zh-HK">中文</a>
          <button id="themeToggle" class="btn btn-ghost" type="button" aria-label="Toggle theme">Theme</button>
        </nav>
      </div>
    </header>

    <main id="main">
      <section class="hero">
        <div class="container">
          <p class="eyebrow">Key project</p>
          <h1 class="hero-title">Real-time Facial Expression Recognition System</h1>
          <p class="hero-lede">A reproducible FER pipeline with teacher→student distillation, calibration, and deployment-facing stability metrics.</p>

          <div class="hero-cta">
            <a class="btn" href="https://github.com/domna735/Real-time-Facial-Expression-Recognition-System" target="_blank" rel="noopener">GitHub repo</a>
            <a class="btn btn-ghost" href="https://github.com/domna735/real-time-FER-demo" target="_blank" rel="noopener">Demo</a>
            <a class="btn btn-ghost" href="../index.html#projects">Back to projects</a>
          </div>

          <div class="callout">
            <strong>Focus:</strong> not only offline macro-F1, but also real-time behaviour: stability (flicker/jitter), latency/FPS constraints,
            calibration, and domain shift from curated datasets to webcam conditions.
          </div>
        </div>
      </section>

      <section class="section" aria-labelledby="evidence-title">
        <div class="container">
          <div class="section-head">
            <h2 id="evidence-title">Evidence</h2>
            <p class="muted">What is public now vs available on request.</p>
          </div>

          <div class="prose">
            <ul class="bullets">
              <li>
                <strong>Public now:</strong>
                <a href="https://github.com/domna735/Real-time-Facial-Expression-Recognition-System" target="_blank" rel="noopener">GitHub repo</a>
                (source code, documentation)
                and
                <a href="https://github.com/domna735/real-time-FER-demo" target="_blank" rel="noopener">Demo repo</a>
                (demo runner / usage).
              </li>
              <li>
                <strong>Available on request:</strong>
                additional artifacts that are large or not committed (e.g., selected checkpoints/weights, extended logs, demo recordings), if needed for review.
              </li>
            </ul>
          </div>
        </div>
      </section>

      <section class="section" aria-labelledby="overview-title">
        <div class="container">
          <div class="section-head">
            <h2 id="overview-title">Overview</h2>
            <p class="muted">Report period: Aug 2025 – Jan 2026 · Document date: 2026-01-28</p>
          </div>

          <div class="prose">
            <p>
              This project rebuilds an end-to-end FER system with an artifact-grounded workflow: each run produces validated manifests,
              checkpoints, and metrics JSONs. The system targets 7 classes (Angry, Disgust, Fear, Happy, Sad, Surprise, Neutral) and
              evaluates both offline classification quality and deployment-facing behaviour under domain shift.
            </p>
            <ul class="bullets">
              <li><strong>Data integrity:</strong> unified multi-source manifest validated at 466,284 samples (0 missing paths, 0 bad labels).</li>
              <li><strong>Teachers:</strong> RN18 / EfficientNet-B3 / ConvNeXt-Tiny trained with an ArcFace-style protocol; macro-F1 ≈ 0.781–0.791.</li>
              <li><strong>Student:</strong> MobileNetV3-Large trained via CE → KD → DKD; KD/DKD improve temperature-scaled calibration but do not exceed CE macro-F1 in the main HQ-train eval.</li>
              <li><strong>Deployment track:</strong> reproducible webcam scoring protocol (raw vs smoothed + flip-rate/jitter) + an offline safety gate for conservative adaptation.</li>
            </ul>
          </div>
        </div>
      </section>

      <section class="section" aria-labelledby="pipeline-title">
        <div class="container">
          <div class="section-head">
            <h2 id="pipeline-title">System pipeline</h2>
            <p class="muted">From dataset cleaning to real-time overlay and logging.</p>
          </div>

          <div class="prose">
            <pre><code>Offline training:
Manifest cleaning → Manifest validation → Teacher training → Ensemble selection → Softlabels export → Student CE/KD/DKD

Real-time demo:
Webcam/video → Face detection (YuNet) → Preprocess (optional CLAHE) → Student inference (ONNX) → Smoothing → Overlay + logs</code></pre>
            <p>
              Stabilisation is treated as a first-class deployment feature: the demo reports both <strong>raw</strong> and <strong>smoothed</strong>
              behaviour because they represent different objectives (instant classifier quality vs perceived user experience).
            </p>
          </div>
        </div>
      </section>

      <section class="section" aria-labelledby="results-title">
        <div class="container">
          <div class="section-head">
            <h2 id="results-title">Results snapshot (artifact-backed)</h2>
            <p class="muted">Numbers are taken directly from run artifacts; calibration reported both raw and temperature-scaled.</p>
          </div>

          <div class="prose">
            <h3>Teachers (Stage A, img224)</h3>
            <div class="table-wrap" role="region" aria-label="Teacher metrics table" tabindex="0">
              <table class="table">
                <thead>
                  <tr>
                    <th>Model</th>
                    <th style="text-align: right">Accuracy</th>
                    <th style="text-align: right">Macro-F1</th>
                    <th style="text-align: right">Raw ECE</th>
                    <th style="text-align: right">TS ECE</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>RN18</td>
                    <td style="text-align: right">0.7862</td>
                    <td style="text-align: right">0.7808</td>
                    <td style="text-align: right">0.2053</td>
                    <td style="text-align: right">0.1489</td>
                  </tr>
                  <tr>
                    <td>EfficientNet-B3</td>
                    <td style="text-align: right">0.7961</td>
                    <td style="text-align: right">0.7910</td>
                    <td style="text-align: right">0.1988</td>
                    <td style="text-align: right">0.0839</td>
                  </tr>
                  <tr>
                    <td>ConvNeXt-Tiny</td>
                    <td style="text-align: right">0.7941</td>
                    <td style="text-align: right">0.7890</td>
                    <td style="text-align: right">0.2009</td>
                    <td style="text-align: right">0.0817</td>
                  </tr>
                </tbody>
              </table>
            </div>

            <h3>Student (HQ-train evaluation)</h3>
            <div class="table-wrap" role="region" aria-label="Student metrics table" tabindex="0">
              <table class="table">
                <thead>
                  <tr>
                    <th>Stage</th>
                    <th style="text-align: right">Accuracy</th>
                    <th style="text-align: right">Macro-F1</th>
                    <th style="text-align: right">Raw ECE</th>
                    <th style="text-align: right">TS ECE</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>CE</td>
                    <td style="text-align: right">0.7502</td>
                    <td style="text-align: right">0.7420</td>
                    <td style="text-align: right">0.1310</td>
                    <td style="text-align: right">0.0499</td>
                  </tr>
                  <tr>
                    <td>KD</td>
                    <td style="text-align: right">0.7347</td>
                    <td style="text-align: right">0.7334</td>
                    <td style="text-align: right">0.2153</td>
                    <td style="text-align: right">0.0278</td>
                  </tr>
                  <tr>
                    <td>DKD</td>
                    <td style="text-align: right">0.7374</td>
                    <td style="text-align: right">0.7375</td>
                    <td style="text-align: right">0.2095</td>
                    <td style="text-align: right">0.0266</td>
                  </tr>
                </tbody>
              </table>
            </div>

            <p class="muted">
              Interpretation: in this run, CE provides the strongest macro-F1; KD/DKD improve temperature-scaled calibration (TS ECE) substantially.
            </p>
          </div>
        </div>
      </section>

      <section class="section" aria-labelledby="domain-title">
        <div class="container">
          <div class="section-head">
            <h2 id="domain-title">Deployment track: domain shift + stability</h2>
            <p class="muted">Measure what users experience: smoothing, jitter, and safe adaptation.</p>
          </div>

          <ul class="bullets">
            <li>Webcam scoring protocol records <strong>raw vs smoothed</strong> accuracy/macro-F1 (when labels available) and <strong>jitter flips/min</strong>.</li>
            <li>Adaptation experiments are guarded by an <strong>offline safety gate</strong> using an eval-only manifest; unsafe checkpoints are rejected.</li>
            <li>NL/NegL screening explores calibration/robustness regularisers, but is treated as sensitive and gated due to potential regressions.</li>
          </ul>

          <details class="details">
            <summary>Key lessons learned</summary>
            <div class="prose">
              <ul class="bullets">
                <li>Artifact-grounded provenance prevents silent drift (manifests, metrics JSON, checkpoints, compare tables).</li>
                <li>Deployment-aligned metrics (stability/jitter) are not implied by offline macro-F1; report both raw and smoothed.</li>
                <li>Domain adaptation needs safety rails; small-buffer fine-tuning can harm generalisation without an offline gate.</li>
                <li>NL/NegL regularisation is sensitive to gating and weighting; treat as an experimental track with strict defaults.</li>
              </ul>
            </div>
          </details>
        </div>
      </section>

      <section class="section" aria-labelledby="repo-title">
        <div class="container">
          <div class="section-head">
            <h2 id="repo-title">Repository</h2>
          </div>

          <div class="callout">
            <p style="margin: 0">
              GitHub: <a href="https://github.com/domna735/Real-time-Facial-Expression-Recognition-System" target="_blank" rel="noopener">Real-time-Facial-Expression-Recognition-System</a>
              <span class="dot" aria-hidden="true">•</span>
              <a href="https://github.com/domna735/real-time-FER-demo" target="_blank" rel="noopener">Demo repo</a>
            </p>
          </div>
        </div>
      </section>
    </main>

    <footer class="site-footer">
      <div class="container footer-row">
        <p class="muted">© <span id="year"></span> Donovan Ma. Built with plain HTML/CSS for GitHub Pages.</p>
        <a class="muted-link" href="../index.html#projects">Back to projects</a>
      </div>
    </footer>

    <script src="../script.js"></script>
  </body>
</html>
